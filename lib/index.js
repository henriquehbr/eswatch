#!/usr/bin/env node
var x=Object.create,m=Object.defineProperty,C=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty,v=Object.getOwnPropertyNames,L=Object.getOwnPropertyDescriptor,A=t=>m(t,"__esModule",{value:!0}),I=(t,o)=>()=>(o||(o={exports:{}},t(o.exports,o)),o.exports),B=(t,o,i)=>{if(A(t),o&&typeof o=="object"||typeof o=="function")for(let e of v(o))!F.call(t,e)&&e!=="default"&&m(t,e,{get:()=>o[e],enumerable:!(i=L(o,e))||i.enumerable});return t},O=t=>t&&t.__esModule?t:B(m(t!=null?x(C(t)):{},"default",{value:t,enumerable:!0}),t),h=I((X,y)=>{"use strict";y.exports=t=>{const o=/^\\\\\?\\/.test(t),i=/[^\u0000-\u0080]+/.test(t);return o||i?t:t.replace(/\\/g,"/")}});import{spawn as D}from"child_process";import{builtinModules as M}from"module";import P from"path";import N from"readline";import{fileURLToPath as T}from"url";import W from"esbuild";import _ from"minimist";const S=()=>{const t=_(process.argv.slice(2));return t};var l=S;const p=O(h());import k from"path";import{existsSync as V}from"fs";const $=async t=>{try{return await new Promise((o,i)=>V(t)?o(t):i(`Couldn't find ${t} entry point`))}catch(o){throw new Error(o)}};var g=$;import G from"is-glob";import R from"tiny-glob";const j=async t=>{const o=k.normalize(t),i=p.default(o),e=await R(i),n=e.map(p.default);return n},z=async t=>{const o=t._.length<1&&!t.entry;if(o)throw new Error("Missing entry point");const i=t.entry?[t.entry]:t._,e=i.map(async r=>G(r)?await j(r):await g(r)),n=await Promise.all(e),a=n.flat();return a};var w=z;const U=P.dirname(T(import.meta.url));let d,b;const s=l(),f=N.createInterface({input:process.stdin,output:process.stdout});w(s).then(t=>b=t);const q=async()=>{const t=s.format==="esm"?s.splitting:!1,o=s.outdir??P.join(U,"build"),i=[...M];if(!s.standalone){const{default:n}=await import("./getDependencies.js");i.push(...await n())}s.external&&i.push(...s.external),d?.kill();const e=await W.startService();return s.clear&&console.clear(),await e.build({bundle:s.bundle,entryPoints:b,format:s.format,minify:s.minify,outdir:o,platform:s.platform,...s.bundle&&{external:i,splitting:t}}),e.stop(),new Promise(n=>{if(s.run){f.pause();const a=typeof s.run=="string"?s.run:`node ${o}`,[r]=a.split(" "),E=a.split(" ").slice(1);d=D(r,E,{stdio:"inherit"}),d.on("close",()=>{f.resume(),s.watch?n():process.exit()})}else console.log(`${s.entry||s._.join(", ")} built successfully on ${s.outdir}`),f.close(),n()})};var c=q;const u=l(),H=async()=>{if(u.version){const{displayVersion:t}=await import("./displayVersion.js");t()}else if(u.watch){const t=await import("chokidar");t.watch(u.watch).on("ready",async()=>c()).on("change",async()=>c())}else c()};H();
